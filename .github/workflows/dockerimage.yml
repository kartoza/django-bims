name: Build and Push Docker Image

on: 
  push: 
    branches:
      - develop

jobs:

  build:
    name: Build and Push Docker Image
    runs-on: ubuntu-16.04
    steps:
    - name: Login to Docker Hub
      uses: actions/docker/login@master
      env:
        DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
        DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
  
  update-rancher:
    name: Update Rancher Stacks
    needs: build
    runs-on: ubuntu-16.04
    steps:
    - name : Update rancher
      run: |
        git clone --depth 1 https://github.com/lucernae/rancher-api-helper.git
        cd rancher-api-helper
        pip install -r requirements.txt
  
